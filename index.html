<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CALENDAXIS DA COMUNICA</title>

<style>
:root {
  --bg:#0b0b0b;
  --card:#1e1e1e;
  --green:#1cff6a;
  --white:#fff;
  --gray:#aaa;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI;}
body{background:var(--bg);color:var(--white);}
header{
  padding:1rem;
  display:flex;
  align-items:center;
  gap:1rem;
  border-bottom:2px solid var(--green);
}
main{padding:1rem;max-width:1300px;margin:auto;}
.calendar-controls{display:flex;justify-content:space-between;align-items:center;margin:1rem 0;}
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;}
.weekday-label{text-align:center;color:var(--green);font-size:.8rem;}
.day-cell{
  background:var(--card);
  min-height:90px;
  padding:6px;
  border-radius:6px;
  cursor:pointer;
}
.badge{font-size:.6rem;border-radius:4px;padding:2px;margin-top:2px;color:#000;}
.type-eventos{background:#1cff6a;}
.type-esportivo{background:#2aff87;}
.type-social{background:#6cffb2;}
.type-patrimonio{background:#0f3d24;color:#fff;}
.type-esports{background:#00ffcc;}
.type-comissao{background:#adff2f;}
.type-outros{background:#fff;}

.side-panel{
  position:fixed;
  right:-100%;
  top:0;
  width:100%;
  max-width:400px;
  height:100%;
  background:#111;
  transition:.3s;
  padding:1rem;
}
.side-panel.active{right:0;}
input,select,textarea,button{
  width:100%;
  margin:.3rem 0;
  padding:.5rem;
  border-radius:5px;
  border:none;
}
button{background:var(--green);font-weight:bold;}

@media(max-width:768px){
  .day-cell{min-height:60px;font-size:.7rem;}
}
</style>
</head>

<body>

<header>
  <h2>CALENDAXIS DA COMUNICA</h2>
</header>

<main>
<div class="calendar-controls">
  <button id="prev">◀</button>
  <h3 id="month"></h3>
  <button id="next">▶</button>
</div>

<div class="calendar-grid" id="grid">
  <div class="weekday-label">Dom</div>
  <div class="weekday-label">Seg</div>
  <div class="weekday-label">Ter</div>
  <div class="weekday-label">Qua</div>
  <div class="weekday-label">Qui</div>
  <div class="weekday-label">Sex</div>
  <div class="weekday-label">Sáb</div>
</div>
</main>

<div class="side-panel" id="panel">
  <h3 id="panelDate"></h3>
  <input type="time" id="time">
  <select id="type">
    <option value="eventos">Eventos</option>
    <option value="esportivo">Esportivo</option>
    <option value="social">Social</option>
    <option value="patrimonio">Patrimônio</option>
    <option value="esports">E-sports</option>
    <option value="comissao">Comissão</option>
    <option value="outros">Outros</option>
  </select>
  <textarea id="text" placeholder="O que vai ser postado?"></textarea>
  <button id="save">Salvar</button>
  <div id="list"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
import { getFirestore, collection, addDoc, deleteDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyANA377U74v8DtVVQUpVFBQwHY-RqL-qBM",
  authDomain: "calendaxis.firebaseapp.com",
  projectId: "calendaxis",
  storageBucket: "calendaxis.firebasestorage.app",
  messagingSenderId: 721182845316SEU_ID",
  appId: "1:721182845316:web:a2c06412c85b446ec915d1"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);
signInAnonymously(auth);

const year = 2026;
let month = 0;
let selectedDate = null;
let posts = [];

const months = ["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];

const grid = document.getElementById("grid");
const panel = document.getElementById("panel");
const panelDate = document.getElementById("panelDate");

const col = collection(db,"calendaxis");

onSnapshot(col,snap=>{
  posts = snap.docs.map(d=>({id:d.id,...d.data()}));
  render();
});

function render(){
  grid.innerHTML = `
  <div class="weekday-label">Dom</div>
  <div class="weekday-label">Seg</div>
  <div class="weekday-label">Ter</div>
  <div class="weekday-label">Qua</div>
  <div class="weekday-label">Qui</div>
  <div class="weekday-label">Sex</div>
  <div class="weekday-label">Sáb</div>`;
  
  document.getElementById("month").innerText = months[month]+" "+year;

  const first = new Date(year,month,1).getDay();
  const days = new Date(year,month+1,0).getDate();

  for(let i=0;i<first;i++) grid.innerHTML+=`<div></div>`;

  for(let d=1;d<=days;d++){
    const date=`${year}-${String(month+1).padStart(2,0)}-${String(d).padStart(2,0)}`;
    const cell=document.createElement("div");
    cell.className="day-cell";
    cell.innerHTML=`<b>${d}</b>`;
    posts.filter(p=>p.date==date).forEach(p=>{
      cell.innerHTML+=`<div class="badge type-${p.type}">${p.time}</div>`;
    });
    cell.onclick=()=>open(date);
    grid.appendChild(cell);
  }
}

function open(date){
  selectedDate=date;
  panel.classList.add("active");
  panelDate.innerText=date.split("-").reverse().join("/");
  renderList();
}

function renderList(){
  const list=document.getElementById("list");
  list.innerHTML="";
  posts.filter(p=>p.date==selectedDate).forEach(p=>{
    list.innerHTML+=`<div class="badge type-${p.type}">${p.time} - ${p.text}</div>`;
  });
}

document.getElementById("save").onclick=async()=>{
  await addDoc(col,{
    date:selectedDate,
    time:time.value,
    type:type.value,
    text:text.value
  });
};

document.getElementById("prev").onclick=()=>{if(month>0){month--;render();}};
document.getElementById("next").onclick=()=>{if(month<11){month++;render();}};

render();
</script>

</body>
</html>
